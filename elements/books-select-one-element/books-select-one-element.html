
<dom-module id="books-select-one-element">
  <style>

    paper-input, paper-input-container {
      color: #000;
    }
    paper-toolbar {
      vertical-align: middle;
    }

    paper-toolbar p {
      margin: 0;
      padding: 0;
    }


  </style>
  <template>
    <paper-header-panel flex>
      <paper-toolbar role="toolbar" elevation="1">
        <div class='back' on-click="goBack">
          <paper-icon-button id="navicon" icon="arrow-back"></paper-icon-button>
        </div>
        <p>{{contentTitle}}</p>
      </paper-toolbar>

      <div class='container'>
        <div class='row'>
          <!-- <div class='col-xs-12'>
            <liste-list-item-element></liste-list-item-element>
          </div> -->
          <div class='col-xs-12'>
            <paper-tabs selected="{{pageSelected}}">
      	      <paper-tab>Libri gi√† catalogati</paper-tab>
      	      <paper-tab>Libri da GoodReads</paper-tab>
      	    </paper-tabs>
            <iron-pages selected="{{pageSelected}}">
      				<div id='myCatalog'>
                <paper-radio-group>
                  <book-radio-item-element></book-radio-item-element>
                  <book-radio-item-element></book-radio-item-element>
                </paper-radio-group>
              </div>
              <div id='goodreadsCatalog'>
                <paper-radio-group>
                  <book-radio-item-element></book-radio-item-element>
                  <book-radio-item-element></book-radio-item-element>
                  <book-radio-item-element></book-radio-item-element>
                  <book-radio-item-element></book-radio-item-element>
                </paper-radio-group>
              </div>
            </iron-pages>
          </div>
        </div>

      </div>

      <paper-fab icon="done" on-click='saveBooks' id='nextButton' disabled="true"></paper-fab>
    </paper-header-panel>
  </template>
</dom-module>

<script>
  Polymer({
    is: "books-select-one-element",

    properties: {
      visibilityValue: {
        type: Boolean,
        value: false
      },
      contentTitle: {
        type: String,
        value: "Romanzi preferiti"
      },
      pageSelected: {
        type: Number,
        value: 0
      },
      type: {
        String: String
      }
    },

    goBack: function () {
      var contentType = this.type;
      this.async(function () {
        if (contentType === 'library') {
          page.redirect('/new/library');
        } else {
          page.redirect('/new/lista');
        }
      }, 100);
    },

    end: function () {
      var contentType = this.type;
      this.async(function () {
        if (contentType === 'library') {
          page.redirect('/library/detail');
        } else {
          page.redirect('/lista/detail');
        }

      }, 100);
    },

    saveBooks: function () {
      var scope = (this.pageSelected === 0) ? this.$.myCatalog : this.$.goodreadsCatalog;
      var items = Polymer.dom(scope).querySelectorAll('book-checkbox-item-element');
      var itemsSelected = [];
      for (var i = 0; i < items.length; ++i) {
        if (items[i].selected) {
          itemsSelected.push(items[0])
        }
      }
      console.log('itemSelected', itemsSelected);

      if (itemsSelected.length === 0) {
        // no book selected, show alert
        this.$.noBooksAlert.open();
      } else {
        this.end();
      }

    },

    visibilityChanged: function (toggle) {
      this.visibilityValue = this.$.visibility.selected;
    },

    ready: function () {
      console.log(this.type);

      if (this.type === 'loan') {
        this.contentTitle = "Nuovo prestito";
      }
    }

  });
</script>
